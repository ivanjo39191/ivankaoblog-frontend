<template>
  <div>
    <h1>Login Page</h1>
    <div class="row vertical inset" data-width="20rem">
      <input v-model="loginForm.username" type="text" placeholder="Username" data-space-bottom="0.5rem" />
      <input v-model="loginForm.password" type="password" placeholder="Password" data-space-bottom="0.5rem" />
      <button type="primary" @click="handleLogin" >Login</button>
      <br>
      <button @click="removeCookie">Clear</button>
    </div>
  </div>
</template>

<script>
// 引入js-cookie
import Cookies from 'js-cookie'
export default {
  data() {
    return{
      loginForm: {
        username: '',
        password: '',
        token: ''
      }
    }
  },
  // methods
  methods: {
    handleLogin() {
      const token = 'asds32adsavrAS3Fadf5567' // token本身就是加密過的字串，隨意
      let username = this.loginForm.username
      let password = this.loginForm.password
      // 帳號密碼需驗證不能為空
      if (username !== '' && password !== '') {
        this.loginForm.token = token
      } else {
        alert('帳號密碼不能為空')
      }
      
      Cookies.set('login', JSON.stringify(this.loginForm), { expires: 1 })
      console.log(this.loginForm)
      
      // cookie當中有token被設置才能改變路由
      if (Cookies.get('login') && this.loginForm.token) {
        this.$router.push({name: 'home'})
      }
    },
    
    // 將Cookies清除的測試用button事件
    removeCookie() {
      Cookies.remove('login')
    }
  }
}

</script>